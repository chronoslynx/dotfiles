iter () {
	echo "$*" | tr " " "\n"
}

fresh freshshell/fresh bin/fresh --bin=~/.local/bin/fresh

# dotfiles
fresh https://gitlab.com/timods/dotfiles 'config/*' --file
fresh https://gitlab.com/timods/dotfiles 'shell/*'
fresh https://gitlab.com/timods/dotfiles 'aliases/*'
fresh https://gitlab.com/timods/dotfiles 'xresources/*' --file=~/.Xresources

fresh gdbinit/Gdbinit 'gdbinit' --file=~/.gdbinit
fresh larkery/zsh-histdb . --file=~/.zsh-histdb/
fresh tarjoilija/zgen 'zgen.zsh' --file=~/.zgen.zsh
fresh tarjoilija/zgen '_zgen' --file=~/.zsh/_zgen

## binfiles
fresh wwalker/ssh-find-agent 'ssh-find-agent.sh' --bin=~/.ssh-find-agent.sh

## terminal colors
fresh https://gitlab.com/timods/dotfiles 'colors' --file=~/.colors/

## alacritty
fresh-options --file=~/.config/alacritty/alacritty.yml
  fresh https://gitlab.com/timods/dotfiles alacritty/$(uname -s).alacritty
  fresh https://gitlab.com/timods/dotfiles alacritty/colors.alacritty
fresh-options

SRCD=~/.fresh/source/gitlab.com/timods-dotfiles
for binf in "$SRCD/bin"/*; do
  if [ -f "$binf" ]; then
    binf=$(basename "${binf}")
    fresh https://gitlab.com/timods/dotfiles "bin/$binf" --bin="$HOME/.local/bin/$binf"
  fi
done

## platform-specific setup
un-$(uname -s)
if [ -d "${SRCD}/bin/${un}" ]; then
  for binf in "${SRCD}"/bin/${un}/*; do
    binf=$(basename "${binf}")
    fresh https://gitlab.com/timods/dotfiles "bin/${un}/${binf}" --bin="$HOME/.local/bin/${binf}"
  done
fi

# Install platform-specific deps
test -f "${SRCD}/deps/${un}.sh" && source "${SRCD}/deps/${un}.sh"

if [[ "${un}" == "Darwin" ]]; then
  # Grab all my launchagents
  for la in "${SRCD}"/launchagents/*.plist; do
    la=$(basename "${la}")
    fresh https://gitlab.com/timods/dotfiles "launchagents/$la" --file="~/Library/LaunchAgents/$la"
  done
fi
